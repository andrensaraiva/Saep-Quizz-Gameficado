<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Quiz Platform</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body class="admin-body">
    <!-- Header -->
    <header class="admin-header">
        <div class="container header-content">
            <h1>‚öôÔ∏è Painel Administrativo</h1>
            <nav>
                <span id="admin-username"></span>
                <button onclick="backToMain()" class="btn-secondary">‚Üê Voltar ao Quiz</button>
                <button onclick="logout()" class="btn-danger">Sair</button>
            </nav>
        </div>
    </header>

    <!-- Sidebar -->
    <div class="admin-layout">
        <aside class="admin-sidebar">
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                    <span class="icon">üìä</span> Dashboard
                </a>
                <a href="#" class="nav-item" onclick="showSection('courses')">
                    <span class="icon">üìö</span> Cursos
                </a>
                <a href="#" class="nav-item" onclick="showSection('questions')">
                    <span class="icon">‚ùì</span> Quest√µes
                </a>
                <a href="#" class="nav-item" onclick="showSection('users')">
                    <span class="icon">üë•</span> Usu√°rios
                </a>
                <a href="#" class="nav-item" onclick="showSection('reports')">
                    <span class="icon">üìà</span> Relat√≥rios
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="admin-content">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="admin-section">
                <h2>Dashboard Geral</h2>
                
                <div class="stats-grid-admin">
                    <div class="stat-card-admin">
                        <div class="stat-icon-admin">üë•</div>
                        <div class="stat-value-admin" id="dash-total-users">0</div>
                        <div class="stat-label-admin">Total de Usu√°rios</div>
                    </div>
                    <div class="stat-card-admin">
                        <div class="stat-icon-admin">üìö</div>
                        <div class="stat-value-admin" id="dash-total-courses">0</div>
                        <div class="stat-label-admin">Cursos Criados</div>
                    </div>
                    <div class="stat-card-admin">
                        <div class="stat-icon-admin">‚ùì</div>
                        <div class="stat-value-admin" id="dash-total-questions">0</div>
                        <div class="stat-label-admin">Quest√µes Cadastradas</div>
                    </div>
                    <div class="stat-card-admin">
                        <div class="stat-icon-admin">üìù</div>
                        <div class="stat-value-admin" id="dash-total-attempts">0</div>
                        <div class="stat-label-admin">Tentativas Realizadas</div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Estat√≠sticas Gerais</h3>
                        <ul class="stats-list">
                            <li>
                                <span>Usu√°rios Ativos:</span>
                                <strong id="dash-active-users">0</strong>
                            </li>
                            <li>
                                <span>M√©dia Geral de Acertos:</span>
                                <strong id="dash-average-score">0%</strong>
                            </li>
                            <li>
                                <span>Curso Mais Popular:</span>
                                <strong id="dash-popular-course">-</strong>
                            </li>
                        </ul>
                    </div>

                    <div class="dashboard-card">
                        <h3>Atividades Recentes</h3>
                        <div id="recent-activities"></div>
                    </div>
                </div>
            </section>

            <!-- Courses Section -->
            <section id="courses-section" class="admin-section" style="display:none;">
                <div class="section-header">
                    <h2>Gerenciar Cursos</h2>
                    <button onclick="showAddCourseModal()" class="btn-primary">+ Novo Curso</button>
                </div>

                <div id="courses-list"></div>
            </section>

            <!-- Questions Section -->
            <section id="questions-section" class="admin-section" style="display:none;">
                <div class="section-header">
                    <h2>Gerenciar Quest√µes</h2>
                    <div class="button-group-horizontal">
                        <select id="course-filter" onchange="loadQuestionsByCourse()" class="form-select">
                            <option value="">Selecione um curso...</option>
                        </select>
                        <button onclick="showAIQuestionModal()" class="btn-success">ü§ñ Gerar com IA</button>
                        <button onclick="showAddQuestionModal()" class="btn-primary">+ Nova Quest√£o</button>
                        <button onclick="showImportModal()" class="btn-success">üì§ Importar em Lote</button>
                    </div>
                </div>

                <div id="questions-list"></div>
            </section>

            <!-- Users Section -->
            <section id="users-section" class="admin-section" style="display:none;">
                <h2>Gerenciar Usu√°rios</h2>
                <div id="users-list"></div>
            </section>

            <!-- Reports Section -->
            <section id="reports-section" class="admin-section" style="display:none;">
                <h2>Relat√≥rios</h2>
                
                <div class="reports-tools">
                    <div class="tool-card">
                        <h3>Exportar Dados</h3>
                        <div class="button-group-vertical">
                            <button onclick="exportData('users')" class="btn-secondary">Exportar Usu√°rios (CSV)</button>
                            <button onclick="exportData('courses')" class="btn-secondary">Exportar Cursos (CSV)</button>
                            <button onclick="exportData('scores')" class="btn-secondary">Exportar Pontua√ß√µes (CSV)</button>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h3>Relat√≥rio por Curso</h3>
                        <select id="report-course-select" class="form-select">
                            <option value="">Selecione um curso...</option>
                        </select>
                        <button onclick="generateCourseReport()" class="btn-primary" style="margin-top: 10px; width: 100%;">Gerar Relat√≥rio</button>
                    </div>
                </div>

                <div id="report-content"></div>
            </section>
        </main>
    </div>

    <!-- Modal: Adicionar Curso -->
    <div id="add-course-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('add-course-modal')">&times;</span>
            <h2>Adicionar Novo Curso</h2>
            <form onsubmit="handleAddCourse(event)">
                <input type="text" id="course-name" placeholder="Nome do Curso" required>
                <textarea id="course-description" placeholder="Descri√ß√£o"></textarea>
                <input type="text" id="course-category" placeholder="Categoria (ex: Tecnologia, Sa√∫de...)" required>
                <div class="form-group">
                    <label>Cor do Curso:</label>
                    <input type="color" id="course-color" value="#3b82f6">
                </div>
                <button type="submit" class="btn-large btn-primary">Criar Curso</button>
            </form>
        </div>
    </div>

    <!-- Modal: Adicionar Quest√£o -->
    <div id="add-question-modal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('add-question-modal')">&times;</span>
            <h2>Adicionar Nova Quest√£o</h2>
            <form onsubmit="handleAddQuestion(event)">
                <select id="question-course" required class="form-select">
                    <option value="">Selecione o curso...</option>
                </select>
                <input type="text" id="question-id" placeholder="ID da Quest√£o (ex: q1)" required>
                <input type="text" id="question-capacity" placeholder="Capacidade/Categoria (ex: C1)" required>
                <textarea id="question-context" placeholder="Contexto da quest√£o" required></textarea>
                <textarea id="question-command" placeholder="Pergunta" required></textarea>
                
                <h4>Op√ß√µes (pelo menos 2):</h4>
                <div id="options-container"></div>
                <button type="button" onclick="addOption()" class="btn-secondary">+ Adicionar Op√ß√£o</button>
                
                <button type="submit" class="btn-large btn-primary" style="margin-top: 20px;">Criar Quest√£o</button>
            </form>
        </div>
    </div>

    <!-- Modal: Gerar Quest√£o com IA -->
    <div id="ai-question-modal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('ai-question-modal')">&times;</span>
            <h2>ü§ñ Gerar Quest√£o com Intelig√™ncia Artificial</h2>
            
            <div class="info-box">
                <h4>üí° Como funciona:</h4>
                <p>Preencha os campos abaixo e a IA ir√° gerar uma quest√£o completa de m√∫ltipla escolha para voc√™ revisar e aprovar.</p>
            </div>

            <form onsubmit="handleGenerateAIQuestion(event)">
                <div class="form-group">
                    <label>Provedor de IA:</label>
                    <select id="ai-provider" required class="form-select">
                        <option value="gemini">Google Gemini (Gratuito)</option>
                        <option value="chatgpt">ChatGPT (Requer API Key)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Curso de Destino:</label>
                    <select id="ai-course" required class="form-select">
                        <option value="">Selecione o curso...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Capacidade/Compet√™ncia:</label>
                    <input type="text" id="ai-capacity" placeholder="Ex: C1, L√≥gica de Programa√ß√£o, etc." required>
                    <small>A categoria ou compet√™ncia que esta quest√£o avalia</small>
                </div>

                <div class="form-group">
                    <label>Conte√∫do/Tema da Quest√£o:</label>
                    <textarea id="ai-content" placeholder="Ex: Estruturas de repeti√ß√£o em JavaScript, vari√°veis e tipos de dados, etc." rows="3" required></textarea>
                    <small>Descreva o assunto espec√≠fico que a quest√£o deve abordar</small>
                </div>

                <div class="form-group">
                    <label>N√≠vel de Dificuldade:</label>
                    <select id="ai-difficulty" required class="form-select">
                        <option value="f√°cil">F√°cil</option>
                        <option value="m√©dio">M√©dio</option>
                        <option value="dif√≠cil">Dif√≠cil</option>
                    </select>
                </div>

                <div class="button-group-vertical">
                    <button type="submit" class="btn-large btn-success" id="generate-btn">
                        ü§ñ Gerar Quest√£o
                    </button>
                </div>
            </form>

            <!-- Preview da quest√£o gerada -->
            <div id="ai-preview" style="display:none; margin-top: 20px;">
                <hr>
                <h3>üìù Quest√£o Gerada - Revisar antes de salvar</h3>
                <div id="ai-question-preview" class="question-preview"></div>
                
                <div class="button-group-horizontal" style="margin-top: 20px;">
                    <button onclick="approveAIQuestion()" class="btn-primary">‚úì Aprovar e Salvar</button>
                    <button onclick="rejectAIQuestion()" class="btn-danger">‚úó Rejeitar e Gerar Outra</button>
                    <button onclick="editAIQuestion()" class="btn-secondary">‚úèÔ∏è Editar Manualmente</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Importar Quest√µes -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('import-modal')">&times;</span>
            <h2>Importar Quest√µes em Lote</h2>
            
            <div class="info-box">
                <h4>üìã Formato do arquivo JSON:</h4>
                <p>Cole um array JSON com suas quest√µes no formato:</p>
                <pre style="background: #f5f5f5; padding: 10px; border-radius: 5px; overflow-x: auto;">
[
  {
    "id": "q1",
    "capacidade": "C1",
    "context": "Contexto...",
    "command": "Pergunta?",
    "options": [
      { "text": "Op√ß√£o 1", "justification": "Por que est√° errada" },
      { "text": "Op√ß√£o 2", "correct": true }
    ]
  }
]</pre>
            </div>

            <form onsubmit="handleImportQuestions(event)">
                <select id="import-course" required class="form-select">
                    <option value="">Selecione o curso...</option>
                </select>
                <textarea id="import-json" placeholder="Cole aqui o JSON com as quest√µes..." rows="10" required></textarea>
                <button type="submit" class="btn-large btn-success">Importar Quest√µes</button>
            </form>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>
